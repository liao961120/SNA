---
title: "轉系網絡：文科 vs. 非文科"
subtitle: ""
author: ""
date: "`r format(Sys.Date(), '%B %e, %Y')`"
urlcolor: "blue"
output:
  bookdown::html_document2:
    number_sections: true
    self_contained: false
    css: html/style.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	fig.dim = c(7, 4),
	out.width = '100%',
	dev = 'svg'
)
```

```{r}
library(ggplot2)
library(ggrepel)
plot_xy <- function(data, x, y, color = data$college,
                    title = NULL,
                    xlab = '工作變動性 (2-5 年 vs. 5-10 年)',
                    ylab = '轉系網絡 PageRank') {
  pl <- ggplot(data, 
               aes(x = x, y = y)) +
    geom_point(aes(color = color), size = 0.5) +
    geom_smooth(se = T, formula = y~x, method='lm', 
                size=0.3, alpha = 0.1, color='red') +
    geom_text_repel(aes(label = Id, color = color), 
            size = 1.6, segment.size = 0.15) +
    labs(title = title,
         x = xlab, #'工作變動性 (2-5 年 vs. 5-10 年)'
         y = ylab) +  #轉系網絡之 PageRank
    theme(legend.position = "none")
}
```


```{r}
library(dplyr)

whole <- readr::read_csv('network_attributes.csv') %>% 
  filter(Id != '牙醫學系')
Arts <- readr::read_csv('transfer_Arts_attributes.csv')
nonArts <- readr::read_csv('transfer_nonArts_attributes.csv') %>%
  filter(Id != '牙醫學系')
nonArts_comp <- readr::read_csv('transfer_nonArts_14nodes_attributes.csv') %>%
  filter(Id != '牙醫學系')
```

```{r fig.cap='轉系網絡，綠色為人文領域科系、粉色為非人文領域。這邊使用 Gephi 的 FortAlas2 layout。由這張圖可知，將網絡區分成「人文」、「分人文」兩塊似乎是合理的，因為人文領域的科系在網絡上的位置是接近的。'}
knitr::include_graphics('arts_v_nonArts.png')
```


## 方法

透過 Gephi 篩選出屬於「文學院」、「社科院」以及「法律學院」的科系，這些科系之間形成一個**文科子網絡**。剩下的科系則另外形成一個**非文科子網絡**。換言之，不考慮兩個子網絡之間的連結。

接著去看看兩個子網絡有什麼不同。這邊直接以「產業變動性」和 PageRank 進行比較，發現兩個網絡差異相當巨大。


## 人文領域

```{r}
corr <- cor(Arts$`industr_2nd-3rd`, Arts$pageranks)
```

(ref:subnet-cor) 相關係數：`r round(corr, 4)`

```{r fig.cap='(ref:subnet-cor)'}
plot_xy(Arts, x = Arts$`industr_2nd-3rd`, 
        y = Arts$pageranks,
        title = '人文領域的轉系網絡',
        xlab = '產業變動性 (2-5 年 vs. 5-10 年)',
        ylab = '科系 PageRank') %>% print()
```


### 比較：使用整個轉系網絡

```{r}
filt_whole <- whole %>% filter(isArts == TRUE)
corr <- cor(filt_whole$`industr_2nd-3rd`, filt_whole$transfer_pageranks)
```

(ref:whole-cor) 相關係數：`r round(corr, 4)`

```{r fig.cap='(ref:whole-cor)'}
plot_xy(filt_whole, x = filt_whole$`industr_2nd-3rd`, 
        y = filt_whole$transfer_pageranks,
        title = '人文領域的轉系網絡',
        xlab = '產業變動性 (2-5 年 vs. 5-10 年)',
        ylab = '科系 PageRank') %>% print()
```

## 非人文領域

```{r}
nonArts_comp <- nonArts_comp %>%
  filter(! (Id %in% c('電機工程學系', '資訊工程學系')))
corr <- cor(nonArts_comp$`industr_2nd-3rd`, nonArts_comp$pageranks)
```

(ref:subnet-cor2) 相關係數：`r round(corr, 4)`

```{r fig.cap='(ref:subnet-cor2)'}
plot_xy(nonArts_comp, x = nonArts_comp$`industr_2nd-3rd`, 
        y = nonArts_comp$pageranks,
        title = '工學院、理學院 轉系網絡',
        xlab = '產業變動性 (2-5 年 vs. 5-10 年)',
        ylab = '科系 PageRank') %>% print()
```


```{r}
corr <- cor(nonArts$`industr_2nd-3rd`, nonArts$pageranks)
```

(ref:subnet-cor3) 相關係數：`r round(corr, 4)`

```{r fig.cap='(ref:subnet-cor3)'}
plot_xy(nonArts, x = nonArts$`industr_2nd-3rd`, 
        y = nonArts$pageranks,
        title = '非人文領域的轉系網絡',
        xlab = '產業變動性 (2-5 年 vs. 5-10 年)',
        ylab = '科系 PageRank') %>% print()
```

